package test.resources.test_jobs; import java.util.Arrays; import org.apache.spark.SparkConf; import org.apache.spark.streaming.Duration; import java.util.stream.Stream; import java.util.stream.Stream;
import java.util.Map;
import java.util.AbstractMap.SimpleEntry;
 import org.apache.spark.streaming.api.java.JavaStreamingContext; import java.util.AbstractMap.SimpleEntry; public class SparkStreamingWordCountJava8Translated { public static void main(String[] args) throws Exception { SparkConf sparkConf = new SparkConf().setAppName("SparkJavaStreamingWordCount"); JavaStreamingContext jssc = new JavaStreamingContext(sparkConf, new Duration(5000)); Stream<String> text = jssc.textFileStream("swift2d://data1.lvm/*"); Map<String, Integer> wordCounts = text.flatMap(x -> Arrays.stream(x.split(" "))).map(word -> word.replaceAll("[^a-zA-Z]", "").toLowerCase().trim()).map(word -> new SimpleEntry<String, Integer>(word, 1)).collect(java.util.stream.Collectors.groupingBy(SimpleEntry<String, Integer>::getKey, java.util.stream.Collectors.counting())); wordCounts.print(); jssc.start(); jssc.awaitTermination(); } }
